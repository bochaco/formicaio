## Docker commands to build and publish images on dockerhub

### Build and push the Formica image
```
$ docker build -t bochaco/formica:latest --platform linux/amd64,linux/arm64 -f formica.Dockerfile --push --no-cache .
```

### Build and push the Formicaio image
```
$ docker build -t bochaco/formicaio:latest --build-arg BUILD_ARGS='--features native' --platform linux/amd64,linux/arm64 --push .
```

### Use cached builds, generated by releases, or built manually in stages:

#### Build ARM64 and cache it:
```
$ docker build --cache-from=type=registry,ref=bochaco/formicaio-gh:buildcache-native-v0.6.2-arm64 --cache-to=type=registry,ref=bochaco/formicaio-gh:buildcache-native-v0.6.2-arm64 --platform linux/arm64 --load .
```

#### Build AMD64 and cache it:
```
$ docker build --cache-from=type=registry,ref=bochaco/formicaio-gh:buildcache-native-v0.6.2-amd64 --cache-to=type=registry,ref=bochaco/formicaio-gh:buildcache-native-v0.6.2-amd64 --platform linux/amd64 --load .
```

#### Build both from cache and push index image:
```
$ docker build --cache-from=type=registry,ref=bochaco/formicaio-gh:buildcache-native-v0.6.2-arm64 --cache-from=type=registry,ref=bochaco/formicaio-gh:buildcache-native-v0.6.2-amd64 -t bochaco/formicaio:0.6.2-native --output=type=image --platform linux/arm64,linux/amd64 --push .
```
